@model Course_Project.Models.PostViewModels.Post
@inject UserManager<ApplicationUser> UserManager
@using Course_Project.Data
@inject ApplicationDbContext _context
<section id="comments">
    <div class="container" id="com">
        <h2>Comments</h2>
        @foreach (var comment in _context.Comments)
        {
            if (comment.PostId.Trim() == Model.Id.Trim() && Model.Comments.SingleOrDefault(m => m.Id == comment.Id) == null)
            {
                Model.Comments.Add(comment);
            }
        }
        @if (Model.Comments.Count == 0)
         {
        <p>Be the first to post a comment</p>
        }
        else
        {


    @foreach (var comment in Model.Comments.OrderBy(a => a.CreatedDate))
     {
        var b = comment.Author.ProfilePicture;
    <img src=@comment.Author.ProfilePicture class="img-circle" alt="UserLogo" height="50" width="50" />
    <label>@comment.Text</label>
    @Html.Raw(comment.CreatedDate)
    <br />
    
    <strong> @Html.Raw(comment.Author.UserName)</strong>
    <div>
        <form asp-action="AddLike" asp-route-Id="@comment.Id" asp-route-postId="@Model.Id" data-ajax="true" data-ajax-method="POST" data-ajax-update="#com">
            @Html.Raw(comment.Likes)
            <button type="submit" class="btn btn-link">
                <span class="glyphicon glyphicon-heart"></span>
            </button>
        </form>
    </div>
    <br />
    <br />
        
     }
            
}
    </div>
</section>
